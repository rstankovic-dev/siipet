{% doc %}
  @prompt
    3 column image modules with headline + subhead and icon overlayed on the image , match margin spacing with the rest of the sections and, made side margins adjustable 
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-image-modules-container-{{ ai_gen_id }} {
    margin-left: {{ block.settings.margin_left }}px;
    margin-right: {{ block.settings.margin_right }}px;
  }

  .ai-image-modules-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: {{ block.settings.column_gap }}px;
  }

  .ai-image-module-{{ ai_gen_id }} {
    position: relative;
    border-radius: {{ block.settings.image_border_radius }}px;
    overflow: hidden;
    aspect-ratio: {{ block.settings.image_aspect_ratio }};
    background-color: #f4f4f4;
  }

  .ai-image-module-image-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .ai-image-module-placeholder-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f4f4f4;
  }

  .ai-image-module-placeholder-{{ ai_gen_id }} svg {
    width: 60%;
    height: 60%;
    opacity: 0.3;
  }

  .ai-image-module-overlay-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
      {{ block.settings.overlay_direction }},
      {{ block.settings.overlay_color | color_modify: 'alpha', block.settings.overlay_opacity }}
    );
    display: flex;
    flex-direction: column;
    justify-content: {{ block.settings.content_vertical_alignment }};
    align-items: {{ block.settings.content_horizontal_alignment }};
    padding: {{ block.settings.content_padding }}px;
    text-align: {{ block.settings.text_alignment }};
  }

  .ai-image-module-icon-{{ ai_gen_id }} {
    width: {{ block.settings.icon_size }}px;
    height: {{ block.settings.icon_size }}px;
    margin-bottom: {{ block.settings.icon_spacing }}px;
    color: {{ block.settings.icon_color }};
    flex-shrink: 0;
  }

  .ai-image-module-content-{{ ai_gen_id }} {
    color: {{ block.settings.text_color }};
  }

  .ai-image-module-headline-{{ ai_gen_id }} {
    font-size: {{ block.settings.headline_size }}px;
    font-weight: {{ block.settings.headline_weight }};
    line-height: 1.2;
    margin: 0 0 {{ block.settings.headline_spacing }}px 0;
    color: {{ block.settings.headline_color }};
  }

  .ai-image-module-subhead-{{ ai_gen_id }} {
    font-size: {{ block.settings.subhead_size }}px;
    font-weight: {{ block.settings.subhead_weight }};
    line-height: 1.4;
    margin: 0;
    color: {{ block.settings.subhead_color }};
    opacity: 0.9;
  }

  .ai-image-module-link-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 2;
    text-decoration: none;
  }

  .ai-image-module-{{ ai_gen_id }}:hover .ai-image-module-image-{{ ai_gen_id }} {
    transform: scale(1.05);
  }

  @media screen and (max-width: 990px) {
    .ai-image-modules-container-{{ ai_gen_id }} {
      margin-left: {{ block.settings.margin_left | times: 0.75 }}px;
      margin-right: {{ block.settings.margin_right | times: 0.75 }}px;
    }

    .ai-image-modules-{{ ai_gen_id }} {
      grid-template-columns: repeat(2, 1fr);
      gap: {{ block.settings.column_gap | times: 0.75 }}px;
    }

    .ai-image-module-headline-{{ ai_gen_id }} {
      font-size: {{ block.settings.headline_size | times: 0.9 }}px;
    }

    .ai-image-module-subhead-{{ ai_gen_id }} {
      font-size: {{ block.settings.subhead_size | times: 0.9 }}px;
    }

    .ai-image-module-icon-{{ ai_gen_id }} {
      width: {{ block.settings.icon_size | times: 0.8 }}px;
      height: {{ block.settings.icon_size | times: 0.8 }}px;
    }
  }

  @media screen and (max-width: 749px) {
    .ai-image-modules-container-{{ ai_gen_id }} {
      margin-left: {{ block.settings.margin_left | times: 0.5 }}px;
      margin-right: {{ block.settings.margin_right | times: 0.5 }}px;
    }

    .ai-image-modules-{{ ai_gen_id }} {
      grid-template-columns: 1fr;
      gap: {{ block.settings.column_gap | times: 0.5 }}px;
    }

    .ai-image-module-overlay-{{ ai_gen_id }} {
      padding: {{ block.settings.content_padding | times: 0.75 }}px;
    }

    .ai-image-module-headline-{{ ai_gen_id }} {
      font-size: {{ block.settings.headline_size | times: 0.8 }}px;
    }

    .ai-image-module-subhead-{{ ai_gen_id }} {
      font-size: {{ block.settings.subhead_size | times: 0.8 }}px;
    }

    .ai-image-module-icon-{{ ai_gen_id }} {
      width: {{ block.settings.icon_size | times: 0.7 }}px;
      height: {{ block.settings.icon_size | times: 0.7 }}px;
    }
  }
{% endstyle %}

<div class="ai-image-modules-container-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-image-modules-{{ ai_gen_id }}">
    {% for i in (1..3) %}
      {% liquid
        assign image_key = 'image_' | append: i
        assign headline_key = 'headline_' | append: i
        assign subhead_key = 'subhead_' | append: i
        assign icon_key = 'icon_' | append: i
        assign link_key = 'link_' | append: i

        assign image = block.settings[image_key]
        assign headline = block.settings[headline_key]
        assign subhead = block.settings[subhead_key]
        assign icon = block.settings[icon_key]
        assign link = block.settings[link_key]
      %}

      <div class="ai-image-module-{{ ai_gen_id }}">
        {% if link != blank %}
          <a href="{{ link }}" class="ai-image-module-link-{{ ai_gen_id }}" aria-label="{{ headline | default: 'View more' }}"></a>
        {% endif %}

        {% if image %}
          <img
            src="{{ image | image_url: width: 800 }}"
            alt="{{ image.alt | escape }}"
            class="ai-image-module-image-{{ ai_gen_id }}"
            loading="lazy"
            width="{{ image.width }}"
            height="{{ image.height }}"
          >
        {% else %}
          <div class="ai-image-module-placeholder-{{ ai_gen_id }}">
            {{ 'image' | placeholder_svg_tag }}
          </div>
        {% endif %}

        <div class="ai-image-module-overlay-{{ ai_gen_id }}">
          {% if icon != 'none' %}
            <div class="ai-image-module-icon-{{ ai_gen_id }}">
              {% case icon %}
                {% when 'star' %}
                  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                  </svg>
                {% when 'heart' %}
                  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                  </svg>
                {% when 'gift' %}
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                    <polyline points="20,12 20,22 4,22 4,12"/>
                    <rect x="2" y="7" width="20" height="5"/>
                    <line x1="12" y1="22" x2="12" y2="7"/>
                    <path d="m5,7 0,0c0,-3 3,-3 3,0l4,0c0,-3 3,-3 3,0l0,0"/>
                  </svg>
                {% when 'shield' %}
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                  </svg>
                {% when 'truck' %}
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                    <rect x="1" y="3" width="15" height="13"/>
                    <polygon points="16,8 20,8 23,11 23,16 16,16 16,8"/>
                    <circle cx="5.5" cy="18.5" r="2.5"/>
                    <circle cx="18.5" cy="18.5" r="2.5"/>
                  </svg>
                {% when 'diamond' %}
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                    <polygon points="6,3 18,3 22,9 12,22 2,9"/>
                  </svg>
                {% when 'crown' %}
                  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5zm2.7-2h8.6l.9-5.4-2.1 1.8L12 8l-3.1 2.4-2.1-1.8L7.7 14z"/>
                  </svg>
                {% when 'lightning' %}
                  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                    <polygon points="13,2 3,14 12,14 11,22 21,10 12,10"/>
                  </svg>
              {% endcase %}
            </div>
          {% endif %}

          <div class="ai-image-module-content-{{ ai_gen_id }}">
            {% if headline != blank %}
              <h3 class="ai-image-module-headline-{{ ai_gen_id }}">{{ headline }}</h3>
            {% endif %}
            {% if subhead != blank %}
              <p class="ai-image-module-subhead-{{ ai_gen_id }}">{{ subhead }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "Image modules",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "margin_left",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Left margin",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_right",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Right margin",
      "default": 0
    },
    {
      "type": "range",
      "id": "column_gap",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Column gap",
      "default": 24
    },
    {
      "type": "select",
      "id": "image_aspect_ratio",
      "label": "Image aspect ratio",
      "options": [
        { "value": "1/1", "label": "Square (1:1)" },
        { "value": "4/3", "label": "Landscape (4:3)" },
        { "value": "3/2", "label": "Classic (3:2)" },
        { "value": "16/9", "label": "Wide (16:9)" },
        { "value": "2/3", "label": "Portrait (2:3)" }
      ],
      "default": "4/3"
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Image border radius",
      "default": 24
    },
    {
      "type": "header",
      "content": "Content positioning"
    },
    {
      "type": "select",
      "id": "content_vertical_alignment",
      "label": "Vertical alignment",
      "options": [
        { "value": "flex-start", "label": "Top" },
        { "value": "center", "label": "Center" },
        { "value": "flex-end", "label": "Bottom" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "content_horizontal_alignment",
      "label": "Horizontal alignment",
      "options": [
        { "value": "flex-start", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "flex-end", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "content_padding",
      "min": 16,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Content padding",
      "default": 32
    },
    {
      "type": "header",
      "content": "Overlay"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "label": "Overlay opacity",
      "default": 0.4
    },
    {
      "type": "select",
      "id": "overlay_direction",
      "label": "Overlay direction",
      "options": [
        { "value": "solid", "label": "Solid" },
        { "value": "180deg", "label": "Top to bottom" },
        { "value": "0deg", "label": "Bottom to top" },
        { "value": "90deg", "label": "Left to right" },
        { "value": "270deg", "label": "Right to left" }
      ],
      "default": "180deg"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "headline_size",
      "min": 16,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Headline size",
      "default": 24
    },
    {
      "type": "select",
      "id": "headline_weight",
      "label": "Headline weight",
      "options": [
        { "value": "400", "label": "Normal" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semi-bold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "600"
    },
    {
      "type": "color",
      "id": "headline_color",
      "label": "Headline color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "headline_spacing",
      "min": 4,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Headline bottom spacing",
      "default": 8
    },
    {
      "type": "range",
      "id": "subhead_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Subhead size",
      "default": 16
    },
    {
      "type": "select",
      "id": "subhead_weight",
      "label": "Subhead weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Normal" },
        { "value": "500", "label": "Medium" }
      ],
      "default": "400"
    },
    {
      "type": "color",
      "id": "subhead_color",
      "label": "Subhead color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Icons"
    },
    {
      "type": "range",
      "id": "icon_size",
      "min": 24,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Icon size",
      "default": 48
    },
    {
      "type": "color",
      "id": "icon_color",
      "label": "Icon color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "icon_spacing",
      "min": 8,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Icon bottom spacing",
      "default": 16
    },
    {
      "type": "header",
      "content": "Module 1"
    },
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Image"
    },
    {
      "type": "text",
      "id": "headline_1",
      "label": "Headline",
      "default": "Premium Quality"
    },
    {
      "type": "text",
      "id": "subhead_1",
      "label": "Subhead",
      "default": "Crafted with care and attention to detail"
    },
    {
      "type": "select",
      "id": "icon_1",
      "label": "Icon",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "star", "label": "Star" },
        { "value": "heart", "label": "Heart" },
        { "value": "gift", "label": "Gift" },
        { "value": "shield", "label": "Shield" },
        { "value": "truck", "label": "Truck" },
        { "value": "diamond", "label": "Diamond" },
        { "value": "crown", "label": "Crown" },
        { "value": "lightning", "label": "Lightning" }
      ],
      "default": "star"
    },
    {
      "type": "url",
      "id": "link_1",
      "label": "Link"
    },
    {
      "type": "header",
      "content": "Module 2"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Image"
    },
    {
      "type": "text",
      "id": "headline_2",
      "label": "Headline",
      "default": "Fast Shipping"
    },
    {
      "type": "text",
      "id": "subhead_2",
      "label": "Subhead",
      "default": "Free delivery on orders over $50"
    },
    {
      "type": "select",
      "id": "icon_2",
      "label": "Icon",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "star", "label": "Star" },
        { "value": "heart", "label": "Heart" },
        { "value": "gift", "label": "Gift" },
        { "value": "shield", "label": "Shield" },
        { "value": "truck", "label": "Truck" },
        { "value": "diamond", "label": "Diamond" },
        { "value": "crown", "label": "Crown" },
        { "value": "lightning", "label": "Lightning" }
      ],
      "default": "truck"
    },
    {
      "type": "url",
      "id": "link_2",
      "label": "Link"
    },
    {
      "type": "header",
      "content": "Module 3"
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Image"
    },
    {
      "type": "text",
      "id": "headline_3",
      "label": "Headline",
      "default": "Satisfaction Guaranteed"
    },
    {
      "type": "text",
      "id": "subhead_3",
      "label": "Subhead",
      "default": "30-day money back guarantee"
    },
    {
      "type": "select",
      "id": "icon_3",
      "label": "Icon",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "star", "label": "Star" },
        { "value": "heart", "label": "Heart" },
        { "value": "gift", "label": "Gift" },
        { "value": "shield", "label": "Shield" },
        { "value": "truck", "label": "Truck" },
        { "value": "diamond", "label": "Diamond" },
        { "value": "crown", "label": "Crown" },
        { "value": "lightning", "label": "Lightning" }
      ],
      "default": "shield"
    },
    {
      "type": "url",
      "id": "link_3",
      "label": "Link"
    }
  ],
  "presets": [
    {
      "name": "Image modules"
    }
  ]
}
{% endschema %}